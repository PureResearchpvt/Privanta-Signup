<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Forgot password for Privanta</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root { --bg:#0b1220; --card:#121a2b; --text:#e6ecf2; --muted:#93a0b4; --accent:#6ea8fe; --danger:#ff6b6b; }
    @media (prefers-color-scheme: light) { :root { --bg:#f5f7fb; --card:#ffffff; --text:#0b1220; --muted:#5b6678; --accent:#2b6eff; --danger:#c0392b; } }
    *{box-sizing:border-box} body{margin:0;font-family:Inter,system-ui,Segoe UI,Arial,sans-serif;background:var(--bg);color:var(--text);display:grid;min-height:100svh;place-items:center;padding:24px}
    .card{width:min(440px,100%);background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:24px 22px}
    h1{margin:0 0 10px;font-size:1.4rem} p{margin:0 0 18px;color:var(--muted)}
    label{display:block;margin:14px 0 6px} input{width:100%;padding:12px 14px;border-radius:10px;border:1px solid rgba(255,255,255,.18);background:transparent;color:var(--text)}
    button{width:100%;margin-top:16px;padding:12px 14px;border:0;border-radius:12px;background:var(--accent);color:white;font-weight:600;cursor:pointer}
    button[disabled]{opacity:.6;cursor:not-allowed} .msg{margin-top:12px;font-size:.92rem;display:none}
  </style>
</head>
<body>
  <div class="card">
    <h1>Forgot your password?</h1>
    <p>Enter your email to receive a reset link.</p>

    <form id="form" autocomplete="off">
      <label for="email">Email address</label>
      <input id="email" name="email" type="email" required placeholder="you@example.com" />
      <button id="submitBtn" type="submit">Send reset link</button>
    </form>

    <div id="ok" class="msg" style="color:var(--muted)">If an account exists for that email, a reset link has been sent.</div>
    <div id="err" class="msg" style="color:var(--danger)"></div>
  </div>

  <!-- ES module import (Fix A) -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

    // CONFIG â€” replace RESET_REDIRECT with your actual hosted reset page URL
    const SUPABASE_URL = "https://jprxjqaqptribtpownjs.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpwcnhqcWFxcHRyaWJ0cG93bmpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NTcxMTIsImV4cCI6MjA2OTQzMzExMn0.lsFWp52gDcmckDdPu8TGmyLlA7cAnfEJuRKlOJV5bzw";
    const RESET_REDIRECT = "https://pureresearchpvt.github.io/Privanta-Signup/reset_password.html";

    // create (or reuse) client instance
    const supabase = window.__sb ?? (window.__sb = createClient(SUPABASE_URL, SUPABASE_ANON_KEY));

    const form = document.getElementById('form');
    const btn  = document.getElementById('submitBtn');
    const ok   = document.getElementById('ok');
    const err  = document.getElementById('err');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      ok.style.display = 'none';
      err.style.display = 'none';
      err.textContent = '';

      const email = (document.getElementById('email').value || '').trim();
      if (!email) return;

      btn.disabled = true;
      try {
        const { error } = await supabase.auth.resetPasswordForEmail(email, { redirectTo: RESET_REDIRECT });
        if (error) {
          err.textContent = error.message || String(error);
          err.style.display = 'block';
        }
        ok.style.display = 'block'; // generic success (prevents account enumeration)
      } catch (e2) {
        err.textContent = e2.message || String(e2);
        err.style.display = 'block';
        ok.style.display = 'block';
      } finally {
        btn.disabled = false;
        form.reset();
      }
    });
  </script>
</body>
</html>

